"use strict";(self.webpackChunkreact_task3=self.webpackChunkreact_task3||[]).push([[474],{474:(e,t,a)=>{a.r(t),a.d(t,{DashBoardExport:()=>W,default:()=>H});var n=a(791);const s=n.createContext({products:{},fetchProducts:()=>{},addProduct:e=>{},editProduct:(e,t)=>{},deleteProduct:e=>{},adding:!1,submitted:void 0,setSubmitted:()=>{},edited:!1,setEdited:()=>{},errorMessage:void 0,setErrorMessage:e=>{},toggleAdding:()=>{}});var c=a(243),l=a(184);function o(e){const[t,a]=(0,n.useState)({}),[o,r]=(0,n.useState)(!1),[i,d]=(0,n.useState)(),[u,m]=(0,n.useState)(!1),[h,x]=(0,n.useState)(),p=(0,n.useCallback)((async()=>{x(),console.log("fetching");try{const e=await c.Z.get("".concat("https://react-11af9-default-rtdb.firebaseio.com","/products.json"));a(e.data)}catch(e){x(e.message),console.error(e)}}),[]);(0,n.useEffect)((()=>{p()}),[p]);const g=(0,n.useCallback)((async e=>{x(),console.log("adding the following product",e);try{const t=await c.Z.post("".concat("https://react-11af9-default-rtdb.firebaseio.com","/products.json"),e);console.log("response",t),d(t.data.name),p()}catch(t){x(t.message),console.error(t)}}),[p]),f=(0,n.useCallback)((async(e,t)=>{x(),console.log("editing"),console.log("editing the product with ID ".concat(e)),console.log("new product details",t);try{const a=await c.Z.put("".concat("https://react-11af9-default-rtdb.firebaseio.com","/products/").concat(e,".json"),t);console.log("response",a),m(!0),p()}catch(a){x(a.message),console.error(a)}}),[p]),N=(0,n.useCallback)((async e=>{x(),console.log("deleting"),console.log("deleting product with ID ".concat(e));try{const t=await c.Z.delete("".concat("https://react-11af9-default-rtdb.firebaseio.com","/products/").concat(e,".json"));console.log("response",t),p()}catch(t){x(t.message),console.error(t)}}),[p]),j={products:t,fetch:p,addProduct:g,editProduct:f,deleteProduct:N,adding:o,submitted:i,setSubmitted:d,edited:u,setEdited:m,errorMessage:h,setErrorMessage:x,toggleAdding:()=>{r((e=>!e))}};return(0,l.jsx)(s.Provider,{value:j,children:e.children})}const r=n.memo(o);var i=a(984);const d=n.forwardRef(((e,t)=>{const a=(0,n.useRef)();return(0,n.useImperativeHandle)(t,(()=>({getValue:()=>a.current.value})),[]),(0,l.jsxs)("div",{className:"form-group row pb-2 ".concat(e.className&&e.className),children:[(0,l.jsx)("label",{htmlFor:e.name,className:"col-sm-2 col-form-label",children:e.name}),(0,l.jsxs)("div",{className:"col-sm-10",children:[e.textarea&&(0,l.jsx)("textarea",{className:"form-control",id:e.name,rows:"3",ref:a,value:e.value,onChange:e.onChange,onBlur:e.onBlur,defaultValue:e.defaultValue,readOnly:e.readOnly,...e.input}),!e.textarea&&(0,l.jsx)("input",{type:"text",className:"form-control",id:e.name,ref:a,value:e.value,onChange:e.onChange,onBlur:e.onBlur,defaultValue:e.defaultValue,readOnly:e.readOnly,...e.input})]})]})}));var u=a(119),m=a(430),h=a(817);const x={input:"",touched:""},p=(e,t)=>{switch(t.type){case"SET_INPUT":return{...e,input:t.input};case"BLUR":return{...e,touched:!0};default:return x}};const g=function(e){const[t,a]=(0,n.useReducer)(p,x);let s=!e||e(t.input);const c=!s&&t.touched;return[t.input,e=>{a({type:"SET_INPUT",input:e})},s,c,e=>{a({type:"SET_INPUT",input:e.target.value})},e=>{a({type:"BLUR"})},()=>{a({type:"RESET"})}]},f="ProductForm_form__3OYhm",N="ProductForm_invalid__kHoRD",j="ProductForm_error-text__u1+hb",b=e=>0!==e.trim().length;const v=function(e){const t=(0,n.useContext)(s),[a,c]=(0,n.useState)(!0);let o;e.content&&(o={...e.content},delete o.ID);const[r,x,p,v,k,C,w]=g(b),[y,_]=(0,n.useState)(o?o["Alt Name"]:""),[D,I,P,S,E,F,Z]=g(b),[M,T,A,B,O,R,W]=g((e=>e>=1)),[H,U]=(0,n.useState)(o?o.New:"false"),[V,q,K,L,Y,z,Q]=g((e=>0===e.toString().trim().length||1<=parseInt(e)&&parseInt(e)<100)),[X,G]=(0,n.useState)({image:o?o.Image:"",valid:!0});o&&a&&(c(!1),x(o.Name),I(o.Description),T(o.Price),q(o.Discount?o.Discount:""));let J=p&&P&&A&&K;return(0,l.jsxs)("form",{id:"form",className:f,children:[(0,l.jsx)(d,{className:"".concat(v&&N),name:"Name",input:{placeholder:"Name"},value:r,onChange:k,onBlur:C}),v&&(0,l.jsx)("p",{className:j,children:"Invalid Name"}),(0,l.jsx)(d,{name:"Alt Name",input:{placeholder:"Alt Name (Same As Name By Default)"},value:y,onChange:e=>{_(e.target.value)}}),(0,l.jsx)(d,{className:"".concat(S&&N),name:"Description",input:{placeholder:"Description"},value:D,onChange:E,onBlur:F,textarea:!0}),S&&(0,l.jsx)("p",{className:j,children:"Invalid Description"}),(0,l.jsx)(d,{className:"".concat(B&&N),name:"Price",input:{placeholder:"Price",type:"number",min:1,step:.01},value:M,onChange:O,onBlur:R}),B&&(0,l.jsx)("p",{className:j,children:"Invalid Price"}),(0,l.jsx)("fieldset",{className:"form-group py-2",children:(0,l.jsxs)("div",{className:"row",children:[(0,l.jsx)("legend",{className:"col-form-label col-sm-2 pt-0",children:"New"}),(0,l.jsx)("div",{className:"col-sm-10",children:(0,l.jsxs)("div",{className:"form-check px-0",children:[(0,l.jsx)(h.Z,{className:"m-0",name:"New",id:"true",value:"true",onChange:U.bind(null,"true"),checked:o&&"true"===o.New}),(0,l.jsx)("label",{className:"form-check-label me-5",htmlFor:"true",children:"True"}),(0,l.jsx)(h.Z,{className:"m-0",name:"New",id:"false",value:"false",onChange:U.bind(null,"false"),checked:!(o&&o.New)}),(0,l.jsx)("label",{className:"form-check-label me-5",htmlFor:"false",children:"False"})]})})]})}),(0,l.jsx)(d,{className:"".concat(!K&&N),name:"Discount",input:{placeholder:"Discount Percentage (1-99)",type:"number",min:1,step:1,max:99},value:V,onChange:Y,onBlur:z}),!K&&(0,l.jsx)("p",{className:j,children:"Invalid Discount"}),(0,l.jsx)(d,{className:"".concat(!X.valid&&N),name:"Image",onChange:e=>{var t=e.target.files[0],a=new FileReader;a.onloadend=function(){G({image:a.result,valid:a.result.startsWith("data:image/webp;base64,")&&a.result.trim().length>"data:image/webp;base64,".trim().length})},(0,i.Z)(t,{fileType:"image/webp",initialQuality:.95}).then((e=>{const t=new File([e],"test.webp",{type:"image/webp"});a.readAsDataURL(t)}))},input:{type:"file",accept:"image/*"}}),!X.valid&&(0,l.jsx)("p",{className:j,children:"Invalid Image"}),(0,l.jsx)("div",{className:"form-group row pt-3",children:(0,l.jsxs)("div",{className:"container-fluid d-flex justify-content-end",children:[(0,l.jsx)(u.Z,{onClick:a=>{a.preventDefault();let n=X.image.startsWith("data:image/webp;base64,")&&X.image.length>23;if(G((e=>({...e,valid:n}))),J=J&&n,!J)return;let s={name:r,alt:0===y.trim().length?r:y,description:D,price:parseFloat(M),src:X.image};"true"===H&&(s={...s,new:"true"}),0!==V.toString().trim().length&&(s={...s,discount:parseInt(V)}),o?(s={...s,alt:y},t.editProduct(e.ID,s)):t.addProduct(s),w(),_(""),Z(),W(),U("false"),Q(),G({image:"default",valid:!1}),e.onClick()},className:"mx-2",text:"Submit",disabled:!J}),(0,l.jsx)(m.Z,{onClick:e.onClick,className:"mx-2",text:"Cancel"})]})})]})},k="TableHeader_header-row__mbTZD",C="TableHeader_header-item__+qemo";function w(e){const t=e.headers.map(((e,t)=>(0,l.jsx)("th",{className:C,children:e},"header".concat(t))));return(0,l.jsx)("thead",{children:(0,l.jsx)("tr",{className:k,children:t})})}const y=n.memo(w);var _=a(164);const D={backdrop:"Modal_backdrop__MtgIY","no-form":"Modal_no-form__K74h9",modal:"Modal_modal__KTaFQ","slide-down":"Modal_slide-down__N6TWj"};function I(e){return(0,l.jsx)("div",{className:D.backdrop,onClick:e.onClick})}function P(e){return(0,l.jsx)("div",{className:"".concat(D.modal," ").concat(e.noForm&&D["no-form"]),children:(0,l.jsx)("div",{className:D.content,children:e.children})})}const S=function(e){return(0,l.jsxs)(l.Fragment,{children:[_.createPortal((0,l.jsx)(I,{onClick:e.onClick}),document.getElementById("overlay")),_.createPortal((0,l.jsx)(P,{noForm:e.noForm,children:e.children}),document.getElementById("overlay"))]})};var E=a(234);const F="TableCell_cell-item__RAftp",Z="TableCell_cell-row__hrntF";function M(e){const t=(0,n.useContext)(s),[a,c]=(0,n.useState)(!1),[o,r]=(0,n.useState)(!1),i=()=>{r((e=>!e))};let d=Object.keys(e.content).map(((t,a)=>(0,l.jsxs)("td",{className:F,children:[e.content[t]&&!e.content[t].toString().startsWith("data:image/png;base64,")&&"New"!==t&&e.content[t],e.content[t]&&!e.content[t].toString().startsWith("data:image/png;base64,")&&"New"===t&&(0,l.jsx)(E.Z,{iconName:"bi bi-check-square-fill",style:{color:"#b88e2f"}}),e.content[t]&&e.content[t].toString().startsWith("data:image/png;base64,")&&(0,l.jsx)("img",{src:e.content[t],alt:e.content["Alt Name"],className:"img-fluid w-100",style:{height:"200px"}})]},"cell".concat(e.rowNumber).concat(a))));return d=d.concat((0,l.jsxs)("td",{className:F,children:[!a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(m.Z,{className:"",text:"Edit",onClick:i}),(0,l.jsx)(u.Z,{text:"Delete",onClick:c.bind(null,!0)})]}),a&&(0,l.jsxs)("div",{className:"container",children:[(0,l.jsx)("p",{children:"Confirm Delete?"}),(0,l.jsx)(u.Z,{className:"mx-1",text:"Yes",onClick:t.deleteProduct.bind(null,e.ID)}),(0,l.jsx)(m.Z,{className:"mx-1 px-3",text:"No",onClick:c.bind(null,!1)})]})]},"cell".concat(e.rowNumber,"modify"))),(0,l.jsxs)(l.Fragment,{children:[o&&(0,l.jsxs)(S,{onClick:i,children:[(0,l.jsxs)("p",{className:"m-0 p-3",style:{backgroundColor:"#b88e2f",color:"white"},children:["Editing Product with ID: ",e.ID]}),(0,l.jsx)(v,{onClick:i,edit:!0,ID:e.ID,content:e.content})]}),(0,l.jsx)("tr",{className:Z,children:d})]})}const T=n.memo(M),A="Table_styled-table__nKwMX";const B=function(e){const t=(0,n.useContext)(s),a=Object.keys(t.products).map(((e,a)=>(0,l.jsx)(T,{ID:e,rowNumber:a,content:{ID:e,Name:t.products[e].name,"Alt Name":t.products[e].alt,Description:t.products[e].description,Price:t.products[e].price,New:t.products[e].new,Discount:t.products[e].discount,Image:t.products[e].src}},e)));return(0,l.jsxs)("table",{className:A,children:[(0,l.jsx)(y,{headers:(0,n.useMemo)((()=>["Product ID","Name","Alt Name","Description","Price","New","Discount","Image","Modify"]),[])}),(0,l.jsx)("tbody",{children:a})]})},O="Dashboard_limit-height__dEhql";function R(e){document.title="Dashboard";const t=(0,n.useContext)(s);return(0,l.jsxs)(l.Fragment,{children:[t.errorMessage&&(0,l.jsxs)(S,{onClick:t.setErrorMessage.bind(null,void 0),noForm:!0,children:[(0,l.jsx)("p",{children:"An Error occured"}),(0,l.jsxs)("p",{children:["Error Message: ",t.errorMessage]}),(0,l.jsx)("div",{className:"container text-end",children:(0,l.jsx)(u.Z,{onClick:t.setErrorMessage.bind(null,void 0),className:"mx-2",text:"Ok"})})]}),t.adding&&(0,l.jsx)(S,{onClick:t.toggleAdding,children:(0,l.jsx)(v,{onClick:t.toggleAdding,add:!0})}),t.submitted&&(0,l.jsxs)(S,{noForm:!0,onClick:t.toggleAdding,children:[(0,l.jsxs)("p",{children:["Product Submitted Successfully with ID: ",t.submitted]}),(0,l.jsx)("div",{className:"container text-end",children:(0,l.jsx)(u.Z,{onClick:t.setSubmitted.bind(null,void 0),className:"mx-2",text:"Ok"})})]}),t.edited&&(0,l.jsxs)(S,{noForm:!0,onClick:t.setEdited.bind(null,!1),children:[(0,l.jsx)("p",{children:"Product Edited Successfully"}),(0,l.jsx)("div",{className:"container text-end",children:(0,l.jsx)(u.Z,{onClick:t.setEdited.bind(null,!1),className:"mx-2",text:"Ok"})})]}),(0,l.jsxs)("div",{className:"container-fluid px-5 pb-5 ".concat(O),children:[(0,l.jsx)("div",{className:"container-fluid d-flex justify-content-center my-5",children:(0,l.jsx)(u.Z,{className:"w-25",text:"New Product",onClick:t.toggleAdding})}),(0,l.jsx)(B,{})]})]})}const W=()=>(0,l.jsx)(r,{children:(0,l.jsx)(R,{})}),H=W},119:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(184);const s=function(e){return(0,n.jsx)("button",{className:"btn yellow-button ".concat(e.className&&e.className),style:{fontWeight:"650",fontSize:"16px",lineHeight:"24px"},onClick:e.onClick,hidden:e.hidden,type:e.type,disabled:e.disabled,children:e.text})}},430:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(184);const s=function(e){return(0,n.jsx)("div",{className:"btn yellow-button-outline ".concat(e.className&&e.className),style:{fontWeight:"700",fontSize:"16px",lineHeight:"24px"},onClick:e.onClick,hidden:e.hidden,children:e.text})}},817:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(184);const s=e=>(0,n.jsxs)("div",{className:"form-check form-check-inline ".concat(e.className&&e.className),children:[(0,n.jsx)("input",{"aria-label":e.id,className:"radio-button",type:"radio",name:e.name,id:e.id,value:e.value,defaultChecked:e.checked,onClick:e.onClick,onChange:e.onChange}),e.label&&(0,n.jsx)("label",{class:"form-check-label",for:e.id,children:e.value})]})}}]);
//# sourceMappingURL=474.05db9155.chunk.js.map